---
title: "机械波在固体中的传播(comsol)"
date: 2024-12-09
tags: ["comsol"]
categories: ["做一点仿真"]
draft: false
---

## 一点背景知识

### 有限元法

有限单元法（Finite Element Method）是求解微分方程近似解的一般方法，
其基本思想是将在一个域内满足平衡微分方程和应力边界条件的边值问题用最小势能原理代替，使得求解微分方程转化为求解积分方程。
然后找一组试探解使其满足最小势能原理，这组解就是原问题的近似解。

有限单元法的分析过程包括结构的离散化、单元分析、整体分析和应力的计算等主要环节。
其中单元分析的目的是建立单元的位移模式，并通过单元刚度阵建立节点力与节点位移的关系。
整体分析的目的是将离散化的结构再组装起来，引入边界条件以便求解。
求出位移后可以计算应变和应力等物理量，从而完成有限元的分析。

## 力的传播速度

高中时代曾就某道题和老师讨论过一个问题：力在固体中的传播速度是多少？是声速吗？是光速吗？还是存在一种“超距作用” -- 不需要传播时间？讨论的最后以“与本题无关”为由不了了之。

现在，通过查阅文献[1]，我们发现关于机械波（或者称弹性波）在固体中的传播问题的争论竟然由来已久，而且人们居然还曾经为此提出“弹性以太（elastic ether）”的概念，直到上世纪初，这个概念才被抛弃（相对论果然革新了大家的时空观），大家的研究兴趣也随之荡然无存。直到上世纪三四十年代，相关的研究才多了起来（当然与战争有关），在理论和实验上给出了很多原创性的结果。

对于满足胡克定律的线弹性固体，可以给出纵波和横波传播的理论解：

$$c_l = \sqrt{\frac{E(1-\mu)}{(1+\mu)(1-2\mu)\rho}}$$

$$c_s = \sqrt{\frac{E}{2(1+\mu)\rho}} $$

其中 $E$ 为材料的杨氏模量，$\mu$ 为泊松比，$\rho$ 为密度。纵波 $c_l$ 与横波 $c_s$ 的关系由材料的泊松比决定：

$$\frac{c_s}{c_l} = \sqrt{\frac{1-2\mu}{2(1-\mu)}}$$

为了使波的传播过程更直观，我们可以通过comsol做一个有趣的仿真。

使用几何体如下所示：

<div align=center>
    <img src=./geo2.png width=50% />
</div>

在图中紫色面施加一个 ${0.1}{N}$ 的力，测量 A,B 两点的位移，得到下面的结果：

<div align=center>
    <img src=./move2.png width=50% />
</div>

可以从图中看出很明显的位移延迟。

这是一个原理性的仿真，接着，我们可以把它做得更细致一些，顺便介绍一下用comsol做力学仿真的基本流程。

### 参数定义

在进行模型设置前，对一些参数进行定义，可以使之后对某些参数进行更改或扫描的操作更为便捷，这样的参数设置可以在“全局定义-参数”下进行。在我们的模型中，有必要对激励函数的各项参量进行定义：$u_z=A\sin(2\pi ft+\phi)$，其中 $A=10^{-6} m$,$f=1000 Hz$,$\phi=0$。

<div align=center>
    <img src=./canshu1.png width=50% />
</div>

### 构建几何模型

根据仿真目的来构建几何模型。在comsol中，几何模型可以通过本地的“几何”模块构建，也可以通过导入CAD模型构建。一般而言，对于较简单的模型，可以直接在comsol中构建；而对于复杂的模型，由于操作逻辑的不同，在comsol中绘制显得很繁复，更建议在3D绘图软件中（如SolidWorks）中完成构建，之后再导入到comsol中进行仿真。本次仿真的模型通过SolidWorks绘制后导入comsol。

<div align=center>
    <img src=./zhigan.png width=50% />
</div>

### 材料选取

完成几何模型构建之后，可以根据实际情况添加模型材料，材料既可以从内置材料中添加现有的材料，也可以添加一个空材料，然后自行输入计算所需的参数。这里，我们的金属棒材料选为`Steel AISI 4340`(从内置材料中选择),材料参数如下：

<div align=center>
    <img src=./canshu3.png width=50% />
</div>

### 激励信号

在采用COMSOL软件模拟时,选取合适的激励信号进行模拟,能提高仿真的准确性。这里将激励信号以指定位移的形式施加在紫色面，指定位移的信号为连续的正弦信号，在“组件-定义-波形”下设置参数及波形如下：

<div align=center>
    <img src=./canshu2.png width=50% />
</div>

<div align=center>
    <img src=./wv1.png width=50% />
</div>

{{< admonition note >}}
这里有一点需要注意，在设置初始条件时不能有冲突，否则会导致计算无法进行。比如这里 $\phi$ 的取值将会影响物体的初始位移，如果在“固体力学-初始值”选项下设置位移场的初始值为0，则这里的 $\phi$ 只能为 $0,\pi$。

<div align=center>
    <img src=./canshu4.png width=50% />
</div>
{{< /admonition >}}

### 网格划分

网格划分是生成计算所需的节点和单元,建立有限元模型的一个重要环节,所划分的网格形式对计算精度和计算规模将产生直接影响[7]。网格尺寸过大会降低计算精度;网格尺寸过小,则需要大量的计算资源,增加模型计算时间。COMSOL软件下固体力学弹性波接口的默认设置是使用四次(四
阶)形函数,每个波长仅需要约 1.5 个网格单元（而对于电磁接口，每个波长所需的网格数更多，一般为5-10个网格）。这里我们使用的材料为`Steel AISI 4340`，通过上面的公式计算可得波速约为$5000 m/s$,激励信号为单频信号，信号频率为 $1000 Hz$,则可以计算出 $L<5m$,这个尺寸对网格划分的要求很低（而对于超声检测，或者电磁仿真，激励信号的频率往往很高，这时候网格划分就成为了一个重要的问题）。我们采用“物理场控制网格”中的“常规”网格选项进行划分即可。

<div align=center>
    <img src=./wangge.png width=20% />
</div>

{{< admonition tip >}}
事实上，对于波传播方向确定的问题，使用扫掠网格是更好的选择，有兴趣的话可以尝试一下！
{{< /admonition >}}

### 时间步长

时间步长的选取直接影响求解精度,时间步长过大会导致计算结果精度低;时间步长过小,则需要较大的电脑内存和过长的运算时间。为使求解过程准确,时间步长必须满足奈奎斯特定理和Moser定理[3]。

- 奈奎斯特频率是指允许的最低采样率,即采样频率应不小于实际信号频率的 2 倍,则时间步长 $t_1≤1 \times 10^{-3} s$。
- Moser定理是指一个周期的时间内至少包含20个时间步,则时间步长 $t_2≤5\times 10^{-5} s$。
  
为了不因采样率影响结果的后处理，我们设置每个周期100个时间步，可以同时满足以上两个条件。求解的总时间应大于表面波传播至接收点的时间，我们设置为两个周期,所以最终在“瞬态研究”接口下设置的时间步进为`range(0,2e4/f,2e6/f)` $\mu s$ 。当然，使用 `f` 这个参数的前提是已经在全局定义中完成定义，这里使用 `f` 的目的是为了对 `f` 进行参数化扫描。

### 计算与后处理

至此完成了所有的参数设置，剩下的就交给计算机啦！

等待计算机完成计算之后，可以对结果进行后处理。我们需要提取A,B两点的位移变化，可以在“结果-数据集”栏里添加“三维截点”，通过两点的坐标将结果提取出来（所以这种方法可以提取任意点的结果），抑或直接添加“结果-一维绘图组”，右键可添加“点结果图”，在“点结果图”中的设置栏可以手动从右侧的模型中选择目标点，从而提取结果（这种方法只能选择模型中的已有点，不能通过坐标选择任意点）。
提取结果时要选择好对应的数据集与表达式，比如这里提取的是位移的Z分量:

<div align=center>
    <img src=./weiyi1.png width=50% />
</div>

<div align=center>
    <img src=./weiyi2.png width=50% />
</div>

但不幸的是，虽然可以从图中看到机械波传播的延迟，但却有一些杂波产生的振荡。这时候，想要得到理想的结果，需要分析振荡产生的原因，对应地更改物理场的设置。经过查阅文献，我们发现，这种振荡可能是由于模型的计算域尺寸有限,当弹性波传播至模型的边界时,会发生很强的反射,反射波与激励信号产生混叠,对接收信号（点2）产生干扰。明确问题之后，回到物理场的设置，发现有个“低反射边界”的选项可以有效解决这个问题[4]。所以可以将 点2 所在的顶面设置为低反射边界面，重新进行计算，得到以下结果：

<div align=center>
    <img src=./weiyi3.png width=50% />
</div>

将绘图数据导出，并进行拟合，可以通过相位差计算得到机械波在此材料中的传播速度，与理论计算的值基本相当。


## 参考文献

[1] Kolsky H. Stress waves in solids[J]. Journal of Sound and Vibration, 1964, 1(1): 88-110.

[2] 李庆龄.ANSYS中网格划分方法研究[J].上海电机学院学报,2006,9(5):28-30.

[3] MOSER F,JACOBS L J,QU J M.Modeling elastic wave propagation in waveguides with the finite element method[J].NDT & E International,1999,32(4):225-23.

[4]张鑫明,李萍,李玮,等. 奥氏体不锈钢应力腐蚀微裂纹的非线性表面波检测[J]. 无损检测,2021,43(10):5-11. 